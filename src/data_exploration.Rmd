---
title: "data_exploration"
author: "Miguel Flores & Camila Villazon"
date: "`r Sys.Date()`"
output: html_document
---

# Librerías
```{r}
library(ggplot2)
# Usamos una librería especializada para coeficiente de asimetría
library(moments)
```

# Lectura de Archivos

Para este proyecto se trabajará con el archivo "cardiovascular_disease.csv" en el cual se encuentran datos de pacientes y se repotan los atributo:
1. Idenitficador (ID)
2. Edad en días
3. Edad en años
4. Género
5. Altura en cm
6. Peso en kg
7. Presión sanguínea sistólica
8. Presión sanguínea diastólica
9. Nivel de colesterol (normal, elevado, muy elevado)
10. Nivel de glucosa (normal, elevado, muy elevado)
11. Fuma o no
12. Bebe o no
13. Actividad física
14. Presencia de enfermedad cardiovascular

A continuación abrimos el archivo
```{r}
# Abrir archivo
cvd <- read.csv("../data/cardiovascular_disease.csv")

# Observamos los primeros registros
head(cvd, n = 6)

# Observamos los últimos registros
tail(cvd)

# Observamos las dimensiones
dim(cvd)
```
Contamos con 70,000 registros inicialmente y 14 atributos como se comentó anteriormente.

# Exploración inicial de los datos

Contabilizamos cuántos NAs hay en cada atributo y registro.
```{r}
check_na <- function(data) {
  # Verificar si cada columna tiene al menos un NA
  cols_with_na <- sapply(data, function(col) any(is.na(col)))
  
  # Resultado como lista
  list(cols_with_na = cols_with_na)
}

# Aplicar la función
na_presence <- check_na(cvd)

# Resultados
na_presence$cols_with_na  # TRUE si la columna tiene al menos un NA
```
De esta manera observamos que no hay NAs en ningún atributo, por lo que no habrá problemas en los análisis posteriores.

# Estadística descriptiva

## Medidas de tendencia central: Moda, media, mediana

Calcularemos la media, moda y mediana de todos los atributos numéricos (edad en años, altura, peso, presión sistólica, presión diastólica). 

```{r}

numeric_attributes <- c("age_year","height","weight","ap_hi","ap_lo")

# Inicializar el dataframe vacío con las columnas mean, mode y median
df_mmm <- data.frame(mean = numeric(length(numeric_attributes)),
                     mode = numeric(length(numeric_attributes)),
                     median = numeric(length(numeric_attributes)),
                     max = numeric(length(numeric_attributes)),
                     min = numeric(length(numeric_attributes)),
                     row.names = numeric_attributes)

# Definir la función para calcular las estadísticas
mmm <- function(var) {
  mode <- as.numeric(names(which.max(table(cvd[[var]]))))
  median <- median(cvd[[var]])
  mean <- mean(cvd[[var]])
  max <- max(cvd[[var]])
  min <- min(cvd[[var]])
  
  # Asignar los resultados a la fila correspondiente de df_mmm
  df_mmm[var, ] <<- c(mean = mean, mode = mode, median = median, max = max, min = min)
}

# Aplicar la función a cada elemento de numeric_attributes
invisible(lapply(numeric_attributes, mmm))

# Ver el resultado
df_mmm


```
A primera vista de acuerdo a esta análisis observamos lo siguiente:
- En la edad observamos que nuestra población se encuentra en el grupo de edad de la adulte (27-59 años) en su mayoría y unos cuantos adultos mayores (Mayor a 60 años).
- Respecto a la estatura se observa que la mayoría de personas son de estatuera media, respecto a los extremos vemos valores muy atípicos, lo que se podría explicar por gigantismo o bien enanismo.
- En el peso observamos que la mayoría de las personas se encuentran entre 60kg y 80kg, también observamos valores atípicos abudantes en el caso de personas que pesan más de 100kg y escasos de personas que pesan menos de 40kg.
- En cuanto a las presiones sistólica y diastólica se encuentran en niveles normales en su mayoría, pero también se observan valores muy atípicos en los extremos.

Dados estas observaciones podemos decir que los datos varían mucho, por lo que sacamos la varianza y desviación estándar.

```{r}


# Inicializar el dataframe vacío con las columnas mean, mode y median
df_vs <- data.frame(vari = numeric(length(numeric_attributes)),
                     sd = numeric(length(numeric_attributes)),
                     row.names = numeric_attributes)

# Definir la función para calcular las estadísticas
vs <- function(var) {
  vari <- var(cvd[[var]])
  sd <- sd(cvd[[var]])
  
  # Asignar los resultados a la fila correspondiente de df_mmm
  df_vs[var, ] <<- c(vari=vari, sd=sd)
}

# Aplicar la función a cada elemento de numeric_attributes
invisible(lapply(numeric_attributes, vs))

# Ver el resultado
df_vs


```
De acuerdo a estas observaciones se confirma nuestra suposición de que nuestros datos varían mucho.

Para ver el peso de estos valores extremos veremos los cuartiles.

```{r}
# Función para crear un boxplot para cada variable
boxplots <- function(var) {
  print(ggplot(cvd, aes_string(y = var)) + 
    geom_boxplot(fill = "green") + theme_classic() +
    labs(title = paste("Boxplot of", var), x = "Observations", y = var))
}

# Aplicar la función a cada elemento de numeric_attributes
invisible(lapply(numeric_attributes, boxplots))



```

Pendientes
- Concluir estos boxplots
- Distribución de los datos: histogramas, skewness y curtosis.